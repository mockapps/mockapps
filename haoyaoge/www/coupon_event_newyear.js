webpackJsonp([63],{0:function(e,n,t){"use strict";t(35);var a=t(4),o=t(1),i=t(3),c=t(7),_=t(19),u=_.NEW_YEAR_DATA,m=t(6),r=(t(13),{TITLE:"昊幺哥发红包啦！",DESC:"88元大红包，立即领取！您的愿望，昊幺哥来承包！",ICON:m.shop.logo}),s=parseFloat(new Date(u.START_TIME).getTime(),10)/1e3,p=parseFloat(new Date(u.END_TIME).getTime(),10)/1e3,l=parseFloat((new Date).getTime(),10)/1e3;(s>l||l>p)&&o.showAlert("活动尚未开启",function(){Navigation.reset("index.html")}),o.prepare({requireLogin:!0,shareInfo:{title:r.TITLE,message:r.DESC,timelineMessage:r.TITLE+r.DESC,forceShareToWeChatTimeline:!0,thumbnailURL:r.ICON,waterMark:c.WaterMark.Transparent,shareURL:location.href}},function(){var e=o.getParameter("taken")||!1,n="http://pinduoduo.b0.upaiyun.com/test/",t={BEFORE_RECEIVED:n+"coupon_bg_before_received_new.jpg",AFTER_RECEIVED:n+"coupon_bg_after_received.jpg"},c=n+"coupon_animation_88.png",_=n+"coupon_bg_cover.png",r="http://pinduoduo.b0.upaiyun.com/coupons/cp_bg_yellow_new.png",l="无限制",O="满减券",T=!1,g=[{discount:"30",min_amount:"300",batch_name:"满300减30",cat_name:l,start_time:s,end_time:p,type:O},{discount:"20",min_amount:"200",batch_name:"满200减20",cat_name:l,start_time:s,end_time:p,type:O},{discount:"15",min_amount:"150",batch_name:"满150减15",cat_name:l,start_time:s,end_time:p,type:O},{discount:"10",min_amount:"100",batch_name:"满100减10",cat_name:l,start_time:s,end_time:p,type:O},{discount:"8",min_amount:"80",batch_name:"满80减8",cat_name:l,start_time:s,end_time:p,type:O},{discount:"5",min_amount:"50",batch_name:"满50减5",cat_name:l,start_time:s,end_time:p,type:O}],b={GET_COUPON:n+"coupon_receive_now_new.png",GO_COUPON:n+"coupon_forward_mall_new.png"},d={GET_COUPON:{TOP:"拆开红包领取",BOTTOM:"88元代金券"},GO_COUPON:{TOP:"恭喜您获得昊幺哥88元红包",BOTTOM:"您可以到个人中心查看"},HAS_TAKEN:"您已经领取过优惠券"},h=u.COUPON_BATCH_IDS;2!=m.shop.shopID&&(h=u.COUPON_BATCH_IDS_TEST);var E,f=!0,v=function(e){a(".loadImage").each(function(){return 0===this.height?(f=!1,!1):void 0}),f?(clearTimeout(E),o.call(e)):(f=!0,E=setTimeout(function(){v(e)},500))},C=null,N=function(e){null==C&&(C=avalon.define({$id:"root",coupons:g,buttonLabel:e,messageLabelTop:"",messageLabelBottom:"",received:!1,backgroundUrl:"",animation:"",cover:"",coupon_bg:"",show:"hidden",receiveCoupons:function(){C.buttonLabel==b.GO_COUPON?Navigation.home():U()},forwardCoupons:function(){Navigation.forward("coupons.html")},gotoRank:function(e){e.stopPropagation(),Navigation.forward("rank.html")}}),avalon.scan(),C.received=C.buttonLabel==b.GO_COUPON,C.received?(T?(C.messageLabelTop=d.HAS_TAKEN,C.messageLabelBottom=""):(C.messageLabelTop=d.GO_COUPON.TOP,C.messageLabelBottom=d.GO_COUPON.BOTTOM),C.backgroundUrl=t.AFTER_RECEIVED,C.animation=c,C.cover=_,C.coupon_bg=r):(C.messageLabelTop=d.GET_COUPON.TOP,C.messageLabelBottom=d.GET_COUPON.BOTTOM,C.backgroundUrl=t.BEFORE_RECEIVED),v(function(){C.show="visible",i.hide();var e=a(".bgImage").height(),n=a(".coupon_animation").height(),t=e-n/2.2;T?a(".coupon_animation").css("top",t):setTimeout(function(){a(".coupon_animation").animate({top:t},500),a(".coupon_animation").animate({top:t-10},1e3),a(".coupon_animation").animate({top:t},1e3)},1e3)}))},U=function(e){var n={batch_ids:h};o.apiRequest("POST","coupon_batch/take",n,function(e){i.hide();var n={taken:!0},t=o.buildURL(n);Navigation.replaceURL(t,function(){Navigation.reload()})},function(){i.hide(),C.buttonLabel=b.GO_COUPON},null,null,e)},L=function(){var n=function(){for(var e="coupon_batch/is_taken",n=0;n<h.length;n++)e+=(n>0?"&":"?")+"batch_ids[]="+h[n];return e};if(e){var t={taken:null},a=o.buildURL(t);Navigation.replaceURL(a,function(){P(!0)})}else o.apiRequest("GET",n(),null,function(e){T=1==e.result,P(T)},function(){P(!0)})},P=function(e){N(e?b.GO_COUPON:b.GET_COUPON)};L()})},35:function(e,n){}});