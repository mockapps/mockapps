webpackJsonp([15],{49:function(e,t,n){var o=n(1),s=n(5),a=n(3),r=n(7),c=n(4),i=n(18);e.exports=function(){var e=n(328),t=o.createNodeFromHTML(e),m=!1,l=null,d=null,u=null,_=null,g=null,v=null,b=null,h=null,p=null,f=null,S=function(e,n,o,s,r,c,i,f,S){m||(document.body.appendChild(t),m=!0),l=e,d=o,u=n,_=s,g=c,v=r,b=i,p=f,h=S,C(),a.hide()},k=function(){if(null!=f){f.thumbUrl=d,f.commentContent="";for(var e=0;5>e;e++)document.getElementsByClassName("comment_star_background")[e].style.backgroundPosition="0";f.visible=!0}},C=function(){if(f)return void k();f=avalon.define({$id:"comment",thumbUrl:d,stars:0,commentContent:"",visible:!0,hide:function(){if(f.visible=!1,_&&_.length>0){var e={type:g,sp:document.getElementsByTagName("body")[0].scrollTop},t=o.buildURL(e);s.replaceURL(t,function(){s.forward("coupon_send.html?"+o.buildQuery({coupon_code:_}))})}else null==g&&s.back("orders.html")},submitComments:function(){if(f.stars<=0)return void i.show("您还没有选择星级评分",{showDuration:500,center:!0});if(f.commentContent.length>500)return void o.showToast("评论应在500字以内");var e={goods_id:u,order_sn:l,score:f.stars,comment:f.commentContent.trim()};o.apiRequest("POST","order/goods/review",e,function(e){if(e.rating_id&&parseInt(e.rating_id)>0){if(o.showToast("感谢您的评价！"),localStorage.getItem("ORDER_INFO_CACHES")){for(var t=JSON.parse(localStorage.getItem("ORDER_INFO_CACHES")),n=0;n<t.length;n++)t[n].order_sn==l&&(t[n].shipping_status=r.ShipmentStatus.Received,t[n].rate_status=r.rateStatus.rateUnable,t[n].order_combined_status=r.OrderCombinedStatus.Received,t[n].order_status_desc=r.OrderDesc.Received);if(null!=p){if(p[r.OrderType.All])for(var s=p[r.OrderType.All],n=0;n<s.length;n++)s[n].order_sn==l&&(s[n].shipping_status=r.ShipmentStatus.Received,s[n].rate_status=r.rateStatus.rateUnable,s[n].order_combined_status=r.OrderCombinedStatus.Received,s[n].order_status_desc=r.OrderDesc.Received);if(p[r.OrderType.Evaluating])for(var s=p[r.OrderType.Evaluating],n=0;n<s.length;n++)s[n].order_sn==l&&s.splice(n,1)}if(g==r.OrderType.All&&null!=b)for(var n=0;n<b.length;n++)b[n].order_sn==l&&(b[n].shipping_status=r.ShipmentStatus.Received,b[n].rate_status=r.rateStatus.rateUnable,b[n].order_combined_status=r.OrderCombinedStatus.Received,b[n].order_status_desc=r.OrderDesc.Received);localStorage.setItem("ORDER_INFO_CACHES",JSON.stringify(t))}null==g&&null!=h&&(h.rateStatus=r.rateStatus.rateUnable),setTimeout(function(){f.hide()},1e3)}else o.showToast("评价失败"),f.visible=!1},function(){})}}),avalon.scan();var e=c(window).width()>640?640:c(window).width(),t=.9*e-30;c(".comment_content").css("width",t);var n=c(window).height(),a=(n-320)/2;c(".comment_container_module").css("top",a),c(".comment_star_background").each(function(e){c(this).bind("touchstart",function(){for(var t=0;e+1>t;t++)document.getElementsByClassName("comment_star_background")[t].style.backgroundPosition="-28px";for(var t=e+1;5>t;t++)document.getElementsByClassName("comment_star_background")[t].style.backgroundPosition="0";f.stars=e+1})})};return{load:S}}()},328:function(e,t){e.exports='<div ms-controller="comment" ms-visible="visible">\n    <div class="comment_container_module">\n        <img src="assets/img/cancel_icon-1ae5cacdfb.png" class="comment_cancel_icon" ms-click="hide">\n        <div class="comment_main">\n            <div class="comment_goods_image comment_goods_image_module"><img ms-src="thumbUrl"></div>\n            <div class="comment_expect">\n                <div class="comment_general">整体评价</div>\n                <ul class="comment_ul">\n                    <li class="comment_star_background comment_star_background_module"></li>\n                    <li class="comment_star_background comment_star_background_module"></li>\n                    <li class="comment_star_background comment_star_background_module"></li>\n                    <li class="comment_star_background comment_star_background_module"></li>\n                    <li class="comment_star_background comment_star_background_module"></li>\n                </ul>\n            </div>\n        </div>\n        <textarea class="comment_content comment_content_module" maxlength= "500" ms-duplex="commentContent" placeholder="亲，您对这个商品满意吗？您的评价会帮助我们选择更好的商品哦！"></textarea>\n        <div class="comment_commit_bottom">\n            <div class="comment_commit_button" ms-click="submitComments">提交评价</div>\n        </div>\n    </div>\n    <div class="comment_back"></div>\n</div>\n\n'}});