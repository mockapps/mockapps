webpackJsonp([58],{0:function(t,e,n){n(79);var o=(n(4),n(1)),u=(n(6),n(5)),r=n(3),i=n(7),_={TITLE:"每日抽奖",TEXT:"抽中领大奖！未抽中全额退款+团长免单券！大奖多又多，好礼享不停！",IMG_URL:"http://pinduoduo.b0.upaiyun.com/share/lottery.jpg",WATERMARK:i.WaterMark.Transparent};o.prepare({requireLogin:o.isWeChatPlatform(),shareInfo:{title:_.TITLE,message:_.TEXT,thumbnailURL:_.IMG_URL,shareURL:location.href,waterMark:_.WATERMARK,forceShareToWeChatTimeline:!0}},function(){"use strict";var t,e="即将开始",n="待开奖",_="已开奖",a="马上抢",c="开始",s="结束",l="截止",d=(o.getParameter("event_type")||i.EVENT_TYPE.LUCKY_DRAW,function(t){return 10>t?"0"+t:t});o.changeTitle("每日抽奖");var m=function(t,e){return t.lucky_start_time>e.lucky_start_time?1:-1},y=function(t,e){return t.lucky_end_time>e.lucky_end_time?1:-1},f=function(t,e){return t.lucky_end_time>e.lucky_end_time?-1:1},h=function(e){for(var n=[],o=[],u=[],r=[],i=[],_=0;_<e.length;_++)e[_].lucky_start_time>t?o.push(e[_]):e[_].lucky_end_time<t?"3"==e[_].lucky_status?r.push(e[_]):u.push(e[_]):n.push(e[_]);return n.sort(y),o.sort(m),u.sort(y),r.sort(f),i=n.concat(o).concat(u).concat(r)},p=function(o){for(var u=h(o),r=[],i=0;i<u.length;i++){var m,y=new Object,f=u[i].lucky_status,p=1e3*t,k=1e3*u[i].lucky_start_time,g=1e3*u[i].lucky_end_time,T=new Date(k),v=new Date(g);k>p?(y.if_show_endtime=!0,y.buy_button=e,y.button_class="lottery_buy_button_come",y.depend=c,m=T):p>g?(y.if_show_endtime=!0,"3"==f?y.buy_button=_:y.buy_button=n,y.button_class="lottery_buy_button_off",y.depend=s,m=v):(y.if_show_endtime=!0,y.buy_button=a,y.button_class="lottery_buy_button_on",y.depend=l,m=v),y.day=m.getDate(),y.month=m.getMonth()+1,y.hour=d(m.getHours()),y.minute=d(m.getMinutes()),y.pic_src=u[i].thumb_url,y.goods_name=u[i].goods_name,y.sale_price=(u[i].group.price/100).toFixed(2),y.market_price=(u[i].market_price/100).toFixed(2),y.goods_id=u[i].goods_id,r.push(y)}b(r)},b=function(t){avalon.define({$id:"root",lottery_list:t,lotteryBack:function(){u.back()},selectGoods:function(t){u.forward("goods.html?goods_id="+t)}})},k=function(){var e="lucky_draw_list";o.apiRequest("GET",e,null,function(e){var n=e.goods;t=e.server_time,r.hide(),p(n),avalon.scan()},function(){r.hide()})};k()})},79:function(t,e){}});