webpackJsonp([77],[function(t,o,e){"use strict";var n=e(1),s=e(6),u=e(3),a=e(7),r=e(5);e(47);e(4);window.Hammer=e(39),n.prepare({requireLogin:!0},function(){var t={DEFAULT:"获取订单失败，请稍后再试！",NO_COUPONS:"您还没有优惠券哦~",ORDER_FAILED:"获取订单消息失败！！"},o=s.shop.name+"商城",e={0:"AVAILABLE",1:"FROZEN",2:"USED",3:"BOUND",4:"EXPIRED"},c="http://pinduoduo.b0.upaiyun.com/coupons/",p={REACH:c+"cp_bg_red_new.png",NOT_REACH:c+"cp_bg_yellow_new.png",DEFAULT:c+"cp_bg_gray.png",TUAN_REACH:c+"cp_bg_group_new.png"},_={1:"已使用",2:"已过期"},i="",l=avalon.define({$id:"coupons",couponList:[],available:[],frozen:[],used:[],bound:[],expired:[],currentTab:0,currentList:[],showCurrUsedCoupons:!1,netErr:!1,errorText:t,shopName:o,tabChange:function(t){l.currentTab=parseInt(t),event.preventDefault(),l.currentList=[];var o=[];o=0==l.currentTab?l.$model.available:1==l.currentTab?l.$model.frozen:l.$model.used,l.currentList=o,document.body.scrollTop=0},gotoOrder:function(t){r.forward("order.html?order_sn="+t)},gotogoods:function(t){r.forward("goods.html?goods_id="+t)},gotoRank:function(){r.forward("rank.html")}}),d=function(t){for(var o=t.length,n=0;o>n;n++){var s=t[n];switch(s.status){case e[0]:l.available.push(s);break;case e[1]:l.frozen.push(s);break;case e[2]:l.used.push(s);break;case e[3]:l.used.push(s);break;case e[4]:l.expired.push(s)}}},y=function(t){t.forEach(function(t){var o=t.order_sn||"0",n=t.used_time||"0",s=t.pay_status||"";try{7==parseInt(t.type,10)?"0"!=n?(t.status=e[2],t.freeTuanCoupon_text=_[1]):"1"==t.is_invalid?(t.status=e[4],t.freeTuanCoupon_text=_[2]):i<t.end_time&&i>t.start_time?t.status=e[0]:i<t.start_time?t.status=e[1]:(t.status=e[4],t.freeTuanCoupon_text=_[2]):"0"!=o&&s!=a.PaymentStatus.Unpayed?t.status=e[2]:"0"!=o&&s==a.PaymentStatus.Unpayed?t.status=e[3]:"1"==t.is_invalid?t.status=e[4]:i<t.end_time&&i>t.start_time?t.status=e[0]:i<t.start_time?t.status=e[1]:t.status=e[4]}catch(u){t.status=""}t.cpStyle={};var r=t.cpStyle;r.discount=parseFloat(t.discount)/100,r.cat_id=t.cat_id||"0",r.cat_name=t.cat_name||"无限制",r.type=parseInt(t.type),r.coupon_style={},7==r.type?r.coupon_style.type="团长免单券":t.discount==t.min_amount?r.coupon_style.type="现金券":r.coupon_style.type="满减券",e[0]==t.status||e[1]==t.status?7==r.type?(r.coupon_style.bg_url=p.TUAN_REACH,r.coupon_style.color="coupon_style_group"):t.discount==t.min_amount?(r.coupon_style.bg_url=p.REACH,r.coupon_style.color="coupon_style_yellow"):(r.coupon_style.bg_url=p.NOT_REACH,r.coupon_style.color="coupon_style_red"):(r.coupon_style.bg_url=p.DEFAULT,r.coupon_style.color="coupon_style_gray")}),l.couponList=t,d(l.couponList),l.currentList=l.$model.available,l.showCurrUsedCoupons=!0,u.hide()},m=function(){var t="coupons";n.apiRequest("GET",t,null,function(t){i=t.timestamp,y(t.coupons||[])},function(){y([]),l.netErr=!0})};m(),avalon.scan()})}]);