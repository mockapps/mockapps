webpackJsonp([7],{23:function(e,t,n){var r=n(1),a=n(6),o=n(7),i=n(13),u=n(5),p=n(9),l=n(10);e.exports=function(){var e=r.isWeChatPlatform(),t=r.isNativePlatform(),n="30000",c="get_brand_wcpay_request:ok",d=function(e){return[i.ItemRemoved.code,i.OutOfStock.code,i.GroupInvalid.code,i.OverBuyLimit.code,i.OrderPayed.code,i.PrepayBusy.code,i.GroupCompleted.code].indexOf(e)>=0},y=function(e,t,n){var a=i.messageFromCode(e);return d(e)?void r.showAlert(a,function(){r.call(n,e)}):(e>0&&r.showToast(a),void r.call(n,e))},f=function(e,t){var n=function(e){localStorage.setItem("afterpayed","1"),u.reload(u.GroupUrl+"?group_order_id="+e)},a=function(){u.reload("order.html?order_sn="+e)},i=function(e){var t=null,r=null;null!=e&&(t=e.group_order_id,r=e.pay_status),r==o.PaymentStatus.Payed&&null!=t&&t.length>0?n(t):a()},p=function(){r.apiRequest("GET","order/"+e,null,function(e){i(e)},function(t){y(t,e,a)},!1,!1,!0)};t?p():r.apiRequest("POST","order/unlock?order_sn="+e,null,function(){a()},function(){a()},!1,!1,!0)},s=function(i,u,l){var d=function(e,t){return t?"object"==typeof e&&e.error_code.toString()==n:"object"==typeof e&&e.err_msg==c};r.apiRequest("POST","order/prepay?"+r.buildQuery({order_sn:i,app_id:a.AppID.WeChat}),null,function(n){if(e){var r=function(){WeixinJSBridge.invoke("getBrandWCPayRequest",{appId:n.appId,timeStamp:n.timeStamp.toString(),nonceStr:n.nonceStr,"package":n["package"],signType:n.signType,paySign:n.paySign},function(e){f(i,d(e))})};"undefined"==typeof WeixinJSBridge?setTimeout(function(){"undefined"==typeof WeixinJSBridge?y(0,i,l):r()},2e3):r()}else t&&(n.timestamp=n.timestamp.toString(),p.callNative("JSPay","pay",{type:o.PaymentType.WeChat,params:n},function(e){f(i,!0)},function(e){f(i)},!0))},function(e){y(e,i,l)},!1,!1,!0)},m=function(e,t,n){var i=function(){return l.Current==l.IOS&&"1.1.4"==r.getAppVersion()?a.AppID.AliPayWeb:r.isNativePlatform()?a.AppID.AliPay:a.AppID.AliPayWeb}(),u=function(){return l.Current==l.IOS&&"1.1.4"==r.getAppVersion()?"http://app.yangkeduo.com/alipay_callback.html?order_sn="+e:r.isNativePlatform()?"":r.buildURL({order_sn:e},"alipay_callback.html")}();r.apiRequest("POST","order/prepay?"+r.buildQuery({order_sn:e,app_id:i,return_url:u}),null,function(n){return l.Current==l.IOS&&"1.1.4"==r.getAppVersion()?void(location.href=n.gateway_url+"?"+r.buildQuery(n.query)):void(r.isNativePlatform()?(n.order_sn=e,n.goods_name=t,n.order_amount=(parseFloat(n.order_amount)/100).toString(),p.callNative("JSPay","pay",{type:o.PaymentType.AliPay,params:n},function(t){f(e,!0)},function(t){f(e)},!0)):location.href=n.gateway_url+"?"+r.buildQuery(n.query))},function(t){y(t,e,n)},!1,!1,!0)},g=function(t,n,r,a){switch(t){case o.PaymentType.WeChat:s(n,r,a);break;case o.PaymentType.AliPay:e?y(0,n,a):m(n,r,a);break;default:y(0,n,a)}};return{pay:g,afterPay:f}}()}});