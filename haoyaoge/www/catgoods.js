webpackJsonp([41],{0:function(t,e,n){"use strict";n(70);var o=n(4),i=n(1),a=n(5),r=n(3),s=n(11);i.prepare({requireLogin:!1},function(){var t=i.getParameter("opt_id"),e=i.getParameter("opt_type"),u=i.getParameter("all"),l=[],c=[],f=Math.min(o(window).width(),640),d=function(t,e){var n={opt_id:t,opt_type:e},o="operation/"+t+"/groups?"+i.buildQuery({opt_type:e});i.apiRequest("GET",o,null,function(o){var i=o;l[JSON.stringify(n)]=i,c[JSON.stringify(n)]=Math.floor(Date.now()/1e3),p(i,t,e)},function(){r.hide()})},p=function(t,l,c){var p=t.opt_infos;if(0!=p.length&&parseInt(c)==parseInt(e)){var g=[];g.push({optId:l,optName:"全部",optType:c});for(var v=0;v<p.length;v++)g.push({optId:p[v].id,optName:p[v].opt_name,optType:parseInt(c)+1});h.catList=g}"true"==u&&(u="false",localStorage.removeItem("LAST_CAT_INDEX"),a.replaceURL(i.buildURL({all:"false"})));var m;if(h.catList.length>0&&(m=localStorage.getItem("LAST_CAT_INDEX")||0,h.currentCat=h.catList[m].optId),h.catList.length>0){var y=o(".fixed_nav_item_catgoods").eq(m),S=Math.floor((f-y.width())/2),_=Math.floor(y.offset().left),w=Math.abs(5*(_-S));w>1e3&&(w=1e3);var L=_-S+o(".nav_fixed_catgoods").scrollLeft()+"px";o(".nav_fixed_catgoods").animate({scrollLeft:L},w)}h.currentCat!=l?d(h.currentCat,h.catList[m].optType):n(57)(function(e){e.load(t,function(t){t&&e.show(h.goodsListReady())},null,l)}),s.hasNewMsg(),avalon.scan(document.getElementById("index-content")),t.length<=0&&r.hide()},h=avalon.define({$id:"root",goodsList:[],show:"hidden",catList:[],currentCat:t,maskVisible:!1,isUp:!1,goodsListReady:function(){r.hide(),h.show="visible"},switchList:function(t){var e=h.catList[t].optId,n=h.catList[t].optType;if(h.currentCat==e)return void h.hideAllCats();localStorage.setItem("LAST_CAT_INDEX",t),h.currentCat=e,r.show(),h.show="hidden";var o={opt_id:e,opt_type:n},i=l[JSON.stringify(o)],a=Math.floor(Date.now()/1e3),s=c[JSON.stringify(o)]||a-180;null!=i&&120>=a-s?p(i,e,n):d(e,n),h.hideAllCats()},reloadGoodsByCatName:function(){r.show(),h.show="hidden",load(rankType,!0)},showAllCats:function(){h.maskVisible=!0,setTimeout(function(){h.isUp=!0},100)},hideAllCats:function(){h.isUp=!1,setTimeout(function(){h.maskVisible=!1},100)}});d(t,e)},function(){})},11:function(t,e,n){var o=n(1),i=n(6),a=n(8);n(10);t.exports=function(){var t=3e4,e=1,n={Open:0,Close:1,Authentication:2,Message:3},r=null,s=0,u={},l={},c=[],f=0,d=!1,p=void 0!==window.WebSocket,h=function(){return null!=r&&r.readyState==WebSocket.OPEN},g=function(){h()||null!=r&&r.readyState==WebSocket.CONNECTING||!p||(r=new WebSocket(i.pushDomain+"?"+o.buildQuery({access_token:a.getAccessToken(),role:"user"})),r.onopen=function(){setTimeout(function(){y(),m(n.Open)},50)},r.onclose=function(){setTimeout(function(){d=!1,m(n.Close)},50)},r.onerror=function(t){},r.onmessage=function(t){if(null!=t&&null!=t.data){var e=JSON.parse(t.data);if(null!=e){var o=e.response,i="ok"===e.result;if(!i&&null!=e.result,"auth"==o)return i&&(d=!0),m(n.Authentication,i);var a=e.request_id;if(null!=a){var r=l[a];null!=r&&setTimeout(function(){r(e)},50)}m(n.Message,e)}}})},v=function(t,e){if(null==e)return null;var n=s++;return u[n]={type:t,handler:e},n},m=function(t){for(var e=[],n=1;n<arguments.length;++n)e.push(arguments[n]);for(var o in u){var i=u[o];i.type==t&&setTimeout(function(){i.handler.apply(null,e)},50)}},y=function(t){if(p){var n=null;return"object"==typeof t&&(n=e++,t.request_id=n,c.push(t)),h()?(c.forEach(function(t){r.send(JSON.stringify(t))}),c=[]):g(),n}};return{isOpen:h,isSupport:p,hasAuthenticated:function(){return p?d:!1},onOpen:function(t){return v(n.Open,t)},onClose:function(t){return v(n.Close,t)},onAuthenticationResult:function(t){return p?v(n.Authentication,t):void 0},onMessage:function(t){return p?v(n.Message,t):void 0},unregister:function(t){delete u[t]},keepAlive:function(){if(p)if(h()){var e=Date.now();e-f>=t&&(y({cmd:"heartbeat"}),f=e)}else g()},send:function(t){p&&y(t)},request:function(t,e){if(p){var n=y(t);return null==n||null==e?n:void(l[n]=e)}},hasNewMsg:function(t,e){if(p&&a.hasAccessToken()){var n=JSON.parse(localStorage.getItem("LastPersonalMsg"))||{},i=n.key||0,r=n.time||0;if(0==i||t){var s=Date.now().toString(),u={key:i,time:r};if(3e4>s-r&&!t)return u.time=s,void localStorage.setItem("LastPersonalMsg",JSON.stringify(u));var c=0,f=y({cmd:"latest_conversations",page:1,size:20});l[f]=function(t){for(var n=t.conversations,i=document.querySelector("#footer_personal i"),a=0;a<n.length;a++)"read"!=n[a].status&&c++;null!=i&&0!=c&&i.classList.add("fb-badge1"),u.key=c,u.time=s,localStorage.setItem("LastPersonalMsg",JSON.stringify(u)),null!=e&&o.call(e,c)}}}},alertNotSupport:function(t){p||o.showAlert("您的系统版本不支持这个功能(Android系统版本至少为4.3)",function(){o.call(t)})}}}()},57:function(t,e,n){n(2),t.exports=function(t,e){n.e(25,function(o){o?e():t(n(309))})}},70:function(t,e){}});