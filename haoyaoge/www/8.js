webpackJsonp([8],{30:function(e,i,o){var n=o(4),t=o(1),r=o(5),m=(o(40),o(18)),c=o(8);e.exports=function(){var e=o(345),i=t.createNodeFromHTML(e),s=!1;if(c.hasAccessToken()){var d=localStorage.getItem("LIKEDATA");d=JSON.parse(d)||{};var a=d.id||[],l=d.time,u=!1;0==l&&(u=!0)}var h=!0,g=null,p=Math.min(n(window).width(),640),f=function(e,i,o){null==i&&(i=!0),g=avalon.define({$id:"recommend_grid",recommendList:[],recommendLiHeight:Math.max(.5*p,160)+"px",recommendHeight:Math.max(.5*p,160),recommendImgHeight:.28*p+"px",recommendClickTop:.28*p+20+"px",bottomVisible:i,recommendMarginTop:o+"px",recommendlistReady:function(){n(".recommend_img img").scrollLoadList({attr:"data-url"})}});for(var r=0;r<e.length;r++){var m=e[r].goods_id;e[r].price=parseFloat(e[r].price/100).toFixed(2),e[r].thumb_url=t.upaiyunCompress(e[r].thumb_url),c.hasAccessToken()&&a.indexOf(m)>-1?e[r].islike=!0:e[r].islike=!1}for(var s=[];e.length;)s.push(e.splice(0,3));g.recommendHeight=s.length*g.recommendHeight+35+"px",g.recommendList=s,avalon.scan(),_()},v=function(e){var i=Math.floor(e/3),o=e%3,m=g.recommendList[i][o].goods_id,c={sp:n(document).scrollTop().toString()},s=t.buildURL(c);r.replaceURL(s,function(){var e="goods.html?goods_id="+m,i=t.getParameter("group_order_id")||"";i.length>0&&(e+="&rec_from_group="+i),r.forward(e)})},_=function(){n(".recommend_img").each(function(e){n(this).bind("click",function(){v(e)})}),n(".recommend_title").each(function(e){n(this).bind("click",function(){v(e)})}),n(".like_click").each(function(e){n(this).bind("click",function(){if(h){d=localStorage.getItem("LIKEDATA"),d=JSON.parse(d)||{},a=d.id||[],l=d.time;var i=null;i=n(this).find(".recommend_like");var o=Math.floor(e/3),s=e%3,p=g.recommendList[o][s].goods_id,f=g.recommendList[o][s].islike;if(!c.hasAccessToken()){var v="goods.html?goods_id="+p+"&like_flag=true",_=t.getParameter("group_order_id")||"";_.length>0&&(v+="&rec_from_group="+_),r.reload("login.html?from="+encodeURIComponent(v))}f?(h=!1,t.apiRequest("POST","favorite/unlike/"+p,p,function(e){d.time=e,g.recommendList[o][s].islike=!1,i.removeClass("liked"),a.splice(a.indexOf(p),1),d.id=a,localStorage.setItem("LIKEDATA",JSON.stringify(d)),setTimeout(function(){h=!0},1e3)},null)):(h=!1,t.apiRequest("POST","favorite/like/"+p,p,function(e){d.time=e,g.recommendList[o][s].islike=!0,i.addClass("liked"),u?(m.show("已加入收藏,可在您的个人中心查看",{showDuration:1e3,center:!0}),u=!1):m.show("已加入收藏",{showDuration:500,center:!0}),a.push(p),d.id=a,localStorage.setItem("LIKEDATA",JSON.stringify(d)),setTimeout(function(){h=!0},1e3)},null))}})})};n.fn.scrollLoadList=function(e){var i={attr:"data-url"},o=n.extend({},i,e||{});o.cache=[],n(this).each(function(){var e=this.nodeName.toLowerCase(),i=n(this).attr(o.attr);if(i){var t={obj:n(this),tag:e,url:i};o.cache.push(t)}});var t=function(){var e=n(window).scrollTop(),i=e+n(window).height();return n.each(o.cache,function(o,n){var t=n.obj,r=n.tag,m=n.url;if(t){var c=t.offset().top,s=c+t.height();(c>e&&i>c||s>e&&i>s)&&("img"===r?t.attr("src",m):t.load(m),n.obj=null)}}),!1};t(),n(window).bind("scroll",t)};var k=function(e,o,t,r){s||(o.before?n(o.position).before(i):n(o.position).after(i),s=!0),f(e,t,r)};return{load:k}}()},345:function(e,i){e.exports='<div class="recommend_grid_wrap" ms-controller="recommend_grid">\n    <div id="recommend" class="grid" ms-css-height="recommendHeight" ms-css-margin-top="recommendMarginTop">\n     <div class="recommend_head">你可能还喜欢</div>\n     <div class="bd">\n         <ul ms-repeat-item="recommendList" data-repeat-rendered="recommendlistReady">\n             <li ms-repeat-recommend="item" ms-css-height="recommendLiHeight">\n                 <div class="recommend_img"><img src="http://pinduoduo.b0.upaiyun.com/test/default_square.jpg" ms-data-url = "recommend.thumb_url" ms-css-height="recommendImgHeight"></div>\n                 <div class="recommend_title" ms-text="recommend.goods_name"></div>\n                 <div class="recommend_price">￥<span ms-text="recommend.price"></span></div>\n                 <div class="like_click" ms-css-top="recommendClickTop">\n                     <div class="recommend_like" ms-class-liked="recommend.islike"></div>\n                 </div>\n             </li>\n         </ul>\n     </div>\n    </div>\n    <div class="recommend_bottom" ms-if="bottomVisible">\n        <div class="line"></div>\n        <p>已经到底部了</p>\n    </div>\n</div>'}});