webpackJsonp([19],{318:function(e,s,t){var n=t(1),i=t(7),u=t(13);e.exports=function(){var e="请选择{0}！",s="所有类别都已售罄",l={FREE:0,SELECTED:1,DISABLED:2},a=t(349),r=n.createNodeFromHTML(a),c=!1,o=null,d=null,v=null,m={},k=[],p={},f={},S={},g=[],h={},b={},y="",E=function(){null==o&&(o=avalon.define({$id:"sku_selector",visible:!1,isUp:!1,skusByType:[],currentSelect:{},selectSku:null,currentSkuImg:"",skuSelectHint:"",selectedImgUrl:"",price:"",goodsName:"",checkDisabled:{},goodsNumber:0,showGoodsNumber:d.orderLimit>1,canReduce:!1,canIncrease:!1,show:function(){o.visible=!0,setTimeout(function(){o.isUp=!0},100),n.ui.disableScroll("skus")},hide:function(){n.ui.enableScroll(),o.isUp=!1,setTimeout(function(){o.visible=!1},100)},setSkuSelectHint:function(){var e=k.length;if(!(0>=e)){o.skuSelectHint="请选择"+k[0];for(var s=1;e>s;s++)o.skuSelectHint+=(s+1==e?"和":"、")+k[s]}},confirmOrder:function(){for(var s=0;s<k.length;s++){var t=k[s];if(null==o.currentSelect[t])return y=n.format(e,t),n.showToast(y),void(y="")}null!=event&&event.preventDefault(),v(o.selectSku,o.goodsNumber),o.hide()},selectOneValue:function(s,t,u){var a=p[s],r=S[s][t],c=o.$model.currentSelect;if(o.currentSelect={},c[s]!=t||u){var d=S[s][c[s]];null!=d&&(g[a][d]=l.FREE),c[s]=t,g[a][r]=l.SELECTED}else c[s]=null,g[a][r]=l.FREE;o.currentSelect=c,null!=c[s]&&y==n.format(e,s)&&(y="");for(var v=function(e,s){var t={};for(var n in c)n!=k[e]?t[n]=c[n]:t[n]=f[n][s];for(var u in m)if(m[u].status!=i.SkuStatus.Unavailable){var l=!0,a=m[u].style;for(var r in a)if(null!=t[r]&&t[r]!=a[r]){l=!1;break}if(l)return!0}return!1},h=[],E={},N=0;N<g.length;N++){var s=k[N];E[s]={};for(var I=0;I<g[N].length;I++){if(g[N][I]!=l.SELECTED){var w=v(N,I);g[N][I]=w?l.FREE:l.DISABLED}else h[N]=I;var t=f[s][I];E[s][t]=g[N][I]==l.DISABLED}}var D=b[JSON.stringify(h)];null!=D?(o.selectSku=D,o.currentSkuImg=m[D].imgUrl,o.goodsNumber=1):o.goodsNumber=0,o.updateGoodsNumber(),o.checkDisabled=E},viewSKUImage:function(){event.stopPropagation(),n.viewImages(o.currentSkuImg)},updateGoodsNumber:function(e){if(0==o.goodsNumber)return o.canReduce=!1,o.canIncrease=!1,void(y.length>0&&n.showToast(y));o.canReduce=!0,o.canIncrease=!0;var s=o.goodsNumber+parseInt(e||"0",10);1>=s&&(s=1,o.canReduce=!1);var t=d.orderLimit;t>m[o.selectSku].quantity&&(t=m[o.selectSku].quantity),t>m[o.selectSku].limitQuantity&&m[o.selectSku].limitQuantity>0&&(t=m[o.selectSku].limitQuantity),s>=t&&(o.canIncrease=!1,1==e&&s>t&&n.showToast(u.OverBuyLimit.message),s=t),o.goodsNumber=s}}))},N=function(e){if(null!=o){var t=function(e,s){for(var t=[],n=[],i=0;i<e.length;i++){var u=e[i];t.push(u.spec_key),n.push(u.spec_value)}for(var a={},r=[],i=0;i<t.length;i++){var c=t[i]||"",d=n[i]||"";if(!(c.length<=0||d.length<=0)){if(a[c]=d,null==p[c]){var v=k.length;p[c]=v,k[v]=c,g[v]=[],f[c]=[],S[c]={},o.skusByType.push({type:c,values:[]})}if(null==S[c][d]){var v=p[c],m=f[c].length;S[c][d]=m,f[c][m]=d,o.skusByType[v].values.push(d),g[v][m]=l.FREE}r[p[c]]=S[c][d]}}return h[s]=r,b[JSON.stringify(r)]=s,a},u=function(e){return 0>=e?i.SkuStatus.Unavailable:i.SkuStatus.OnSale};o.selectSku=null;for(var a="",r=0;r<e.length;r++){var c=e[r],v=""+c.skuID,y={skuID:v,imgUrl:c.thumbUrl,style:t(c.specs,v),status:u(c.quantity),quantity:c.quantity,limitQuantity:c.limitQuantity};y.status!=i.SkuStatus.Unavailable&&0==a.length&&(a=v),m[v]=y}if(0==a.length)o.hide(),n.showToast(s);else{o.selectSku=a;for(var r=0;r<h[a].length-1;r++){var E=h[a][r],N=k[r];o.$model.currentSelect[N]=f[N][E],g[r][E]=l.SELECTED}var I=h[a].length-1,E=h[a][I],N=k[I];o.selectOneValue(N,f[N][E],!0)}o.setSkuSelectHint(),o.price=d.price}},I=function(e,s,t,n){c||document.body.appendChild(r),d=s,v=n,E(e),o.goodsName=t,N(e),avalon.scan(r),window.innerHeight>=555&&(document.querySelector(".sku-wrapper").style.maxHeight="555px",document.querySelector("#skus").style.maxHeight="345px")},w=function(){null!=o&&o.show()},D=function(){null!=o&&o.hide()};return{load:I,show:w,hide:D}}()},349:function(e,s){e.exports='<div id="sku_selector" ms-controller="sku_selector" ms-visible="visible">\n    <div class="sku-wrapper" ms-class="sku-slide-up:isUp">\n        <img id="sku-quit" src="http://pinduoduo.b0.upaiyun.com/sku/quit_button.png" ms-click="hide">\n        <div id="sku-head">\n            <img id="sku-image" ms-src="{{currentSkuImg}}" ms-click="viewSKUImage" class="image">\n            <div id="sku-detail">\n                <div class="sku-name">{{goodsName}}\n                    <div class="sku-price-depends">¥{{price}}</div>\n                </div>\n                <div><span id="sku-msg" ms-text="skuSelectHint"></span></div>\n            </div>\n        </div>\n        <div id="skus" class="native-scroll">\n            <div class="sku-info" ms-repeat-item="skusByType">\n                <div class="sku-type" ms-text="item.type"></div>\n                <span ms-repeat-value="item.values">\n                    <span class="goods" ms-click="selectOneValue($outer.item.type, value)" ms-class-disabled="checkDisabled[$outer.item.type][value]" ms-class-checked="currentSelect[$outer.item.type]==value" ms-text="value"></span>\n                </span>\n            </div>\n            <div class="sku-amount" ms-if="showGoodsNumber" style="border-bottom:0;">\n                <div class="sku-text">\n                    <a>购买数量</a>\n                    <div class="sku-buy-amount-increase" ms-click="updateGoodsNumber(1)">\n                        <span ms-class="button-disabled:!canIncrease">&plus;</span>\n                    </div>\n                    <div id="skuNum" class="sku-input-text" ms-text="goodsNumber"></div>\n                    <div class="sku-buy-amount-reduce" ms-click="updateGoodsNumber(-1)">\n                        <span ms-class="button-disabled:!canReduce">&minus;</span>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div id="sku-decide" class="sku-button">\n            <div id="sku-buy" ms-click="confirmOrder">确定</div>\n        </div>\n    </div>\n\n    <div id="sku-hidden" ms-click="hide" ms-if="visible"></div>\n</div>\n'}});