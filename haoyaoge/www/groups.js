webpackJsonp([69],{0:function(o,e,r){"use strict";var n=r(4),u=r(1),t=r(5),d=r(3);u.prepare({requireLogin:!0},function(){function o(o,e){var r=o.groupIndex,d=10;r>=_&&(d=(Math.floor(r/_)+1)*_),I.groupList&&I.groupList.length>d&&(d+=_);var p={sp:n(document).scrollTop().toString(),group_order_id:o.groupOrderID,group_index:r,group_index_needed:d},i=u.buildURL(p);t.replaceURL(i,e)}var e=45,p={SHOW:"pullUp_show",HIDE:"pullUp_hide"},i={DEFAULT:"正在玩命的加载...",NO_GROUP_ORDERS:"没有更多的团订单了..."},l={ON:"loading-spin",OFF:"loading-stop"},s=["组团中","组团成功","组团失败"],g={FIRST:"您还没有参过任何团，快去逛逛吧",DEFAULT:"您还没有任何相关团购哦"},a={ONGOING:"邀请好友参团",DEFAULT:"查看团详情"},c=(Math.min(n(window).width(),640),0),_=10,h=!1,f=!0,m={Init:0,Success:1,Failed:2,All:3},T=u.getParameter("status"),L=[],x=null,I=avalon.define({$id:"groups",groupList:[],groupType:null==T?m.All:parseInt(T,10),loadingClass:p.HIDE,noGroupsAtAll:!1,userInteractionEnabled:!0,loadingTxt:i.DEFAULT,loadingRotateClass:l.ON,noGroupsText:g.FIRST,loadingRotateVisible:!0,goHome:function(){t.home()},gotoGroup:function(e){var r=e.groupOrderID;o(e,function(){t.forward(t.GroupUrl+"?group_order_id="+r)})},gotoOrder:function(e){var r=e.orderSN;o(e,function(){t.forward("order.html?order_sn="+r)})},showLoading:function(){I.loadingClass=p.SHOW},hideLoading:function(){I.loadingClass=p.HIDE},getGroupStatusTxt:function(o){return s[parseInt(o)]},switchList:function(o){if(o!=I.groupType){t.replaceURL(u.buildURL({status:o})),d.show(),I.hideLoading(),I.groupList=[],I.groupType=o,c=0,h=!1,I.noGroupsAtAll=!1;var e=L[o];null==e?(L[o]=[],F()):(I.groupList=JSON.parse(JSON.stringify(e)),I.noGroupsAtAll=0==I.groupList.length?!0:!1,document.body.scrollTop=0,N(),d.hide())}}}),O=function(o){0!=o.length&&(I.noGroupsText=g.DEFAULT),o=o||[],o.length==_||x&&x.sp>0?(h||N(),I.hideLoading(),f=!0):(n(window.document).unbind("scroll"),0==I.groupList.length&&0==o.length?I.noGroupsAtAll=!0:I.groupList.length>=5&&(I.loadingTxt=i.NO_GROUP_ORDERS,I.loadingRotateClass=l.OFF,I.loadingRotateVisible=!1));for(var e=0;e<o.length;e++)o[e].groupIndex=e+I.groupList.length;I.groupList=I.groupList.concat(o),d.hide(),avalon.scan(document.body),x&&x.sp>0&&(document.getElementsByTagName("body")[0].scrollTop=x.sp,x.sp=0)},N=function(){h=!0,n(window.document).scroll(function(){if(f){var o=n(document).scrollTop(),r=n(document).height(),u=n(window).height();o+u+2>=r&&(f=!1,I.showLoading(),n(document).scrollTop(o+e),c++,F())}})},F=function(){var o=function(o){for(var e=function(o){return null==o||null==o.goods_name?null:{goodsName:o.goods_name,goodsNumber:o.goods_number,price:(o.goods_price/100).toFixed(2),thumbUrl:o.thumb_url}},r=[],n=0;n<o.length;n++){var u=o[n],t=e(u.order.order_goods[0]);t&&r.push({discountAmount:(u.discount_amount/100).toFixed(2),groupOrderID:u.group_order_id,groupStatus:u.group_status,orderAmount:(u.order_amount/100).toFixed(2),orderSN:u.order_sn,orderGoods:t,show:parseFloat(t.price)>.09,ongoingGroup:"0"==u.group_status?!0:!1,goToGroupText:"0"==u.group_status?a.ONGOING:a.DEFAULT,groupNumber:u.customer_num+"人团",groupIndex:-1})}return r};null==x&&(x={sp:parseFloat(u.getParameter("sp")||0),groupIndex:parseFloat(u.getParameter("group_index")||0),groupIndexNeeded:parseFloat(u.getParameter("group_index_needed")||_)},t.replaceURL(u.buildURL({sp:null,group_order_id:null,group_index:null,group_index_needed:null})));var e=c+1,r=_;x&&x.sp>0&&x.groupIndexNeeded>_&&(e=1,r=x.groupIndexNeeded,c=x.groupIndexNeeded/_-1,x.groupIndexNeeded=0,x.groupIndex=0);var n="";n=3==I.groupType?"group_orders?"+u.buildQuery({page:e,size:r}):"group_orders?"+u.buildQuery({page:e,size:r,status:I.groupType}),u.apiRequest("GET",n,null,function(e){var r=o(e||[]);O(r),null==L[I.groupType]&&(L[I.groupType]=[]),L[I.groupType].push.apply(L[I.groupType],r),d.hide()},function(){O()})};F(),r(12)(function(){})})},12:function(o,e,r){r(2),o.exports=function(o,e){r.e(6,function(n){n?e():o(r(15))})}}});