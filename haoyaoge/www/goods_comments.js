webpackJsonp([75],[function(t,n,o){"use strict";var e=o(1),a=o(3),i=o(6),s=o(4);e.prepare({requireLogin:!1},function(){var t=20,n="该商品暂时没有相关评论哦",o="没有更多评价了",u="此用户未填写文字评论",l={HIDE:{bottom:"-64px",opacity:"0.0"},SHOW:{bottom:"64px",opacity:"1.0"}},c=e.getParameter("goods_id"),r=!1,m=!1,p=null,g=null,f=function(){g=avalon.define({$id:"goodsComments",amounts:null,showAmounts:!1,isLoading:!1,lists:[],noCommentAtAll:!1,message:"",topButtonBottom:l.HIDE.bottom,topButtonOpacity:l.HIDE.opacity,showMessage:function(){g.noCommentAtAll=!1,m&&(g.lists.length<=0?(g.message=n,g.noCommentAtAll=!0):g.lists.length>=t&&(g.message=o))}}),avalon.scan(),h()},h=function(){if(!r&&!m){null==p&&(p=[]),r=!0,g.isLoading=!0,g.message=null;var n=p.length,o=Math.floor(n/t)+1,a="reviews/"+c+"?"+e.buildQuery({page:o,size:t});e.apiRequest("GET",a,null,function(t){d(t)},function(){v(!1)})}},d=function(t){var n=t.number||null;n&&(g.showAmounts=!0,g.amounts=n);var o=t.data||[];v(o.length);for(var e=function(t){return""==t||0==t.length?[]:0==t[0].spec_key.length||0==t[0].spec_value.length?[]:t},a=0;a<o.length;a++)B(o[a]),A(o[a]),w(o[a]),y(o[a]),o[a].spec=e(o[a].spec||"");p.push.apply(p,o),g.lists.pushArray(o),g.showMessage()},v=function(n){r=!1,m=t>n,g.isLoading=!1},y=function(t){""==t.comment&&(t.comment=u)},w=function(t){t.avatar=t.avatar||"",t.avatar.length<=0&&(t.avatar=i.shop.logo)},b=function(t){return 10>t&&(t="0"+t),t},A=function(t){var n=t.time,n=new Date(1e3*n),o=n.getFullYear(),e=b(n.getMonth()+1),a=b(n.getDate()),i=b(n.getHours()),s=b(n.getMinutes());t.time=o+"-"+e+"-"+a+" "+i+":"+s},B=function(t){t.stars=new Array(parseInt(t.stars))},H=function(){s(document).scroll(function(){null!=g&&(s(document).scrollTop()+s(window).height()>=s(document).height()&&h(),E())})},D=function(){var t=s(".go-top");t.unbind("click"),t.click(function(){event&&event.preventDefault(),document.getElementsByTagName("body")[0].scrollTop=0})},E=function(){var t=2*s(window).height();g.topButtonBottom=l.HIDE.bottom,g.topButtonOpacity=l.HIDE.opacity,s(window).scrollTop()>=t&&(g.topButtonBottom=l.SHOW.bottom,g.topButtonOpacity=l.SHOW.opacity)},I=function(){e.changeTitle("商品评价"),f(),H(),D(),a.hide()};I()})}]);